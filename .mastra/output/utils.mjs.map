{"version":3,"file":"utils.mjs","sources":["../../src/env.js","../../src/inngest/utils.ts"],"sourcesContent":["import { createEnv } from \"@t3-oss/env-nextjs\";\nimport { z } from \"zod\";\n\nexport const env = createEnv({\n  /**\n   * Specify your server-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars.\n   */\n  server: {\n    AUTH_SECRET:\n      process.env.NODE_ENV === \"production\"\n        ? z.string()\n        : z.string().optional(),\n    // AUTH_DISCORD_ID: z.string(),\n    // AUTH_DISCORD_SECRET: z.string(),\n    DATABASE_URL: z.string().url(),\n    E2B_API_KEY: z.string(),\n    NODE_ENV: z\n      .enum([\"development\", \"test\", \"production\"])\n      .default(\"development\"),\n    GEMINI_API_KEY: z.string(),\n    OPENAI_API_KEY: z.string(),\n    PRIVY_APP_SECRET: z.string(),\n    ADMIN_PRIVATE_KEY: z.string(),\n  },\n\n  /**\n   * Specify your client-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars. To expose them to the client, prefix them with\n   * `NEXT_PUBLIC_`.\n   */\n  client: {\n    NEXT_PUBLIC_PRIVY_APP_ID: z.string(),\n    NEXT_PUBLIC_PRIVY_CLIENT_ID: z.string(),\n  },\n\n  /**\n   * You can't destruct `process.env` as a regular object in the Next.js edge runtimes (e.g.\n   * middlewares) or client-side so we need to destruct manually.\n   */\n  runtimeEnv: {\n    AUTH_SECRET: process.env.AUTH_SECRET,\n    DATABASE_URL: process.env.DATABASE_URL,\n    E2B_API_KEY: process.env.E2B_API_KEY,\n    NODE_ENV: process.env.NODE_ENV,\n    GEMINI_API_KEY: process.env.GEMINI_API_KEY,\n    OPENAI_API_KEY: process.env.OPENAI_API_KEY,\n    PRIVY_APP_SECRET: process.env.PRIVY_APP_SECRET,\n    ADMIN_PRIVATE_KEY: process.env.ADMIN_PRIVATE_KEY,\n    NEXT_PUBLIC_PRIVY_APP_ID: process.env.NEXT_PUBLIC_PRIVY_APP_ID,\n    NEXT_PUBLIC_PRIVY_CLIENT_ID: process.env.NEXT_PUBLIC_PRIVY_CLIENT_ID,\n  },\n  /**\n   * Run `build` or `dev` with `SKIP_ENV_VALIDATION` to skip env validation. This is especially\n   * useful for Docker builds.\n   */\n  skipValidation: !!process.env.SKIP_ENV_VALIDATION,\n  /**\n   * Makes it so that empty strings are treated as undefined. `SOME_VAR: z.string()` and\n   * `SOME_VAR=''` will throw an error.\n   */\n  emptyStringAsUndefined: true,\n});\n","import { env } from \"@/env\";\nimport { Sandbox } from \"@e2b/code-interpreter\";\nimport type { AgentResult, TextMessage } from \"@inngest/agent-kit\";\n\nexport async function getSandbox(sandboxId: string) {\n  const sandbox = await Sandbox.connect(sandboxId, {\n    apiKey: env.E2B_API_KEY,\n  });\n  return sandbox;\n}\n\nexport function lastAssistantTextMessageContent(result: AgentResult) {\n  const lastAssistantMessageIndex = result.output.findIndex(\n    (message) => message.role === \"assistant\" && message.type === \"text\",\n  );\n\n  const message = result.output[lastAssistantMessageIndex] as\n    | TextMessage\n    | undefined;\n\n  return message?.content\n    ? typeof message.content === \"string\"\n      ? message.content\n      : message.content.map((c) => c.text).join(\"\")\n    : undefined;\n}\n"],"names":[],"mappings":";;;;AAGO,MAAM,MAAM,SAAA,CAAU;AAAA;AAAA;AAAA;AAAA;AAAA,EAK3B,MAAA,EAAQ;AAAA,IACN,WAAA,EAGM,CAAA,CAAE,MAAA,GAAS,QAAA,EAAS;AAAA;AAAA;AAAA,IAG1B,YAAA,EAAc,CAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI;AAAA,IAC7B,WAAA,EAAa,EAAE,MAAA,EAAO;AAAA,IACtB,QAAA,EAAU,CAAA,CACP,IAAA,CAAK,CAAC,aAAA,EAAe,QAAQ,YAAY,CAAC,CAAA,CAC1C,OAAA,CAAQ,aAAa,CAAA;AAAA,IACxB,cAAA,EAAgB,EAAE,MAAA,EAAO;AAAA,IACzB,cAAA,EAAgB,EAAE,MAAA,EAAO;AAAA,IACzB,gBAAA,EAAkB,EAAE,MAAA,EAAO;AAAA,IAC3B,iBAAA,EAAmB,EAAE,MAAA;AAAO,GAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAA,EAAQ;AAAA,IACN,wBAAA,EAA0B,EAAE,MAAA,EAAO;AAAA,IACnC,2BAAA,EAA6B,EAAE,MAAA;AAAO,GACxC;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,UAAA,EAAY;AAAA,IACV,WAAA,EAAa,QAAQ,GAAA,CAAI,WAAA;AAAA,IACzB,YAAA,EAAc,QAAQ,GAAA,CAAI,YAAA;AAAA,IAC1B,WAAA,EAAa,QAAQ,GAAA,CAAI,WAAA;AAAA,IACzB,QAAA,EAAU,aAAA;AAAA,IACV,cAAA,EAAgB,QAAQ,GAAA,CAAI,cAAA;AAAA,IAC5B,cAAA,EAAgB,QAAQ,GAAA,CAAI,cAAA;AAAA,IAC5B,gBAAA,EAAkB,QAAQ,GAAA,CAAI,gBAAA;AAAA,IAC9B,iBAAA,EAAmB,QAAQ,GAAA,CAAI,iBAAA;AAAA,IAC/B,wBAAA,EAA0B,QAAQ,GAAA,CAAI,wBAAA;AAAA,IACtC,2BAAA,EAA6B,QAAQ,GAAA,CAAI;AAAA,GAC3C;AAAA;AAAA;AAAA;AAAA;AAAA,EAKA,cAAA,EAAgB,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,mBAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAK9B,sBAAA,EAAwB;AAC1B,CAAC;;AC1DD,eAAsB,WAAW,SAAA,EAAmB;AAClD,EAAA,MAAM,OAAA,GAAU,MAAM,OAAA,CAAQ,OAAA,CAAQ,SAAA,EAAW;AAAA,IAC/C,QAAQ,GAAA,CAAI;AAAA,GACb,CAAA;AACD,EAAA,OAAO,OAAA;AACT;;;;"}